import{T as M,k as q,j as L,z as U,f as p,a as f,b as a,g as w,e as Z,u as n,F as h,m as y,v,B as x,t as k,c as C,o as c,n as A,a0 as I}from"./app-551012d8.js";import{T as H}from"./Toast-07128877.js";/* empty css             *//* empty css                   */import R from"./Newitem-cfa9c9a3.js";import G from"./CerrarYguardar-a1c53782.js";import O from"./Add_Sub_items-ca05234a.js";import K from"./formOferta-65909d25.js";import{n as J}from"./global-6d1c7c87.js";import{E as Q}from"./ErroresNuevaOferta-766563ec.js";import{d as W}from"./focusStore-50e14bee.js";/* empty css                                              */import"./_plugin-vue_export-helper-c27b6911.js";import"./TextInput-4b8270d6.js";import"./Add_Sub_equipos-f939d446.js";import"./vue-select.es-e7a5a940.js";import"./InputError-23c0a787.js";import"./FactorModal-3003c42d.js";import"./Modal-e8455b5b.js";import"./PrimaryButton-bd076b11.js";import"./SecondaryButton-ec5b0153.js";import"./PencilIcon-7035d21d.js";const X=a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 13l-3 3m0 0l-3-3m3 3V8m0 13a9 9 0 110-18 9 9 0 010 18z"})],-1),Y=[X],ee=a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 13l-3 3m0 0l-3-3m3 3V8m0 13a9 9 0 110-18 9 9 0 010 18z"})],-1),oe=[ee],te=a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 11l3-3m0 0l3 3m-3-3v8m0-13a9 9 0 110 18 9 9 0 010-18z"})],-1),ae=[te],re={class:"space-y-6"},le={key:0,class:"flex justify-center mt-4 mb-1"},se=a("img",{src:"/demco-logo-ultimo.png",alt:"Logo Demco",class:"h-12"},null,-1),ie=[se],ne=["onSubmit"],ce={class:"grid grid-cols-1 sm:grid-cols-3 lg:grid-cols-6 gap-6 p-4"},de=["for"],me=["id","onUpdate:modelValue","placeholder"],ue={class:"col-span-1 relative bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-300 ease-in-out overflow-hidden"},pe={class:"p-4"},fe=a("label",{class:"block font-semibold text-gray-700 dark:text-gray-300 mb-2"}," Factor seleccionado ",-1),ge={class:"text-gray-600 body-font"},he={class:"container mx-auto"},be={class:"flex flex-col text-center mx-auto w-full max-w-[300px] bg-white py-4 mt-12 mb-20 rounded-xl border border-collapse border-green-400"},_e=a("h1",{class:"sm:text-xl text-lg font-medium title-font mb-4 text-gray-900"}," Valor total de la oferta ",-1),we={class:"text-2xl lg:w-2/3 mx-auto leading-relaxed"},ye=a("hr",{class:"border-[1px] border-black my-8 col-span-full"},null,-1),Ze={__name:"NuevaOferta",props:{numberPermissions:Number,plantilla:Number,ultimaCD:Number,theuser:Object},setup(V){const i=V;let E=0;const t=M({dataOferta:{cliente:"",codigo_oferta:"CD"+i.ultimaCD,descripcion:"DEMCO INGENIERÍA, es una empresa dinámica dedicada al diseño, construcción y puesta en servicio de subestaciones y tableros eléctricos en media y baja tensión, desarrollando proyectos con altas especificaciones en ingeniería, en alianza con reconocidas empresas del sector eléctrico. Entregamos a nuestros clientes soluciones completas e integrales respaldados por procesos de ingeniería y automatización, ágiles y con importantes alianzas con reconocidas empresas del sector. Somos una empresa Colombiana con proyección hacia el futuro, contamos con productos de calidad, precios competitivos, recurso humano calificado, capacidad operativa y respuesta oportuna a nuestros cliente.",cargo:"",empresa:"",ciudad:"Medellín",proyecto:""},items:[],ultra_valor_total:0}),r=q({params:{pregunta:""},mostrarDetalles:!0,EquipsOnZero:!1,CallOnce_Plantilla:!0,hijosZeroFlags:[],factores:[{title:"Factor Suministro",value:1.33},{title:"Factor MT",value:1.5},{title:"Factor BT",value:1.6},{title:"Factor Cobre",value:1.55},{title:"Factor por Ingenieria Adicional",value:1}],factorSeleccionado:1});L(()=>{U(),t.dataOferta.cargo=i.theuser.cargo||" El usuario no tiene cargo asignado",i.plantilla==="1"&&d(9),i.plantilla==="2"&&d(10),i.plantilla==="99"&&d(2)});const N=()=>r.CallOnce_Plantilla=!1;function g(){t.ultra_valor_total=t.items.reduce((e,o)=>e+(o.valor_total||0),0)}function S(e,o){t.items[e]&&(t.items[e]=o,g())}function z(e,o){t.items[e]&&(t.items[e].nombre=o)}function D(e){b({index:e,isok:!1}),W(e,t,r,g),console.log("achu",r.hijosZeroFlags)}function d(e){for(;t.items.length<e;)t.items.push({id:E++,nombre:`Item ${t.items.length+1}`,cantidad:1,equipos:[],valor_total:0});for(;t.items.length>e;)t.items.pop();g()}function b({index:e,isZero:o}){r.hijosZeroFlags[e]=o,r.EquipsOnZero=r.hijosZeroFlags.includes(!0)}function P(){i.numberPermissions>9&&j(),window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})}function F(){const e=Array.from(document.querySelectorAll('[id^="itemN"]'));let o=-1;const l=window.innerHeight;e.forEach((s,m)=>{const u=s.getBoundingClientRect();u.bottom>0&&u.top<l&&(o=m)}),o>=0&&o<e.length-1&&e[o+1].scrollIntoView({behavior:"smooth",block:"center"})}function T(){const e=Array.from(document.querySelectorAll('[id^="itemN"]'));let o=-1;const l=window.innerHeight;e.forEach((s,m)=>{const u=s.getBoundingClientRect();u.bottom>0&&u.top<l&&(o=m)}),o>=0&&o<e.length-1&&o>0?e[o-1].scrollIntoView({behavior:"smooth",block:"center"}):window.scrollTo(0,0)}function j(){I.forEach(t.items,e=>{I.forEach(e.equipos,o=>{o&&o.equipo_selec&&(o.equipo_selec.precio_de_lista==0||o.equipo_selec.precio_de_lista==null)&&(o.equipo_selec.precio_de_lista=111)})})}function B(){const e=!(!t.dataOferta.cargo||!t.dataOferta.empresa);return e||alert("Los campos cargo y empresa son obligatorios"),e}function $(){let e=t.items.length>0;return e||alert("Debe haber al menos un item en la oferta"),e}const _=()=>{$()&&B()?t.post(route("GuardarNuevaOferta"),{preserveScroll:!0,onSuccess:()=>{},onError:()=>null,onFinish:()=>null}):alert("Hay campos vacios o no hay items")};return window.addEventListener("keydown",e=>{if(e.ctrlKey&&e.key.toLowerCase()==="a"){e.preventDefault();const o=t.items.length+1;d(o)}}),(e,o)=>(c(),p(h,null,[f(H,{flash:e.$page.props.flash},null,8,["flash"]),a("button",{type:"button",onClick:P,class:"fixed top-4 left-4 z-50 bg-blue-500 hover:bg-blue-700 text-white font-bold py-3 px-3 rounded-full shadow-lg","aria-label":"Ir a Valor nulo!"},Y),a("button",{type:"button",onClick:F,class:"fixed top-24 left-4 z-50 bg-amber-500 hover:bg-orange-700 text-white font-bold py-3 px-3 rounded-full shadow-lg","aria-label":"Siguiente item"},oe),a("button",{onClick:T,class:"fixed top-4 right-4 z-50 bg-blue-500 hover:bg-blue-700 text-white font-bold py-3 px-3 rounded-full shadow-lg","aria-label":"Anterior item"},ae),a("section",re,[r.mostrarDetalles?(c(),p("div",le,ie)):w("",!0),a("form",{onSubmit:Z(_,["prevent"]),class:"px-16 py-1 2xl:px-8 2xl:py-4 print-container"},[f(K,{modelValue:n(t).dataOferta,"onUpdate:modelValue":o[0]||(o[0]=l=>n(t).dataOferta=l),numberPermissions:i.numberPermissions,class:""},null,8,["modelValue","numberPermissions"]),a("div",ce,[(c(!0),p(h,null,y(r.factores,(l,s)=>(c(),p("div",{key:s,class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-300 ease-in-out overflow-hidden"},[a("div",{class:A([{"bg-indigo-100 dark:bg-indigo-900":s==r.factorSeleccionado-1},"p-4"])},[a("label",{for:`factor-input-${s}`,class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},k(l.title),9,de),v(a("input",{id:`factor-input-${s}`,type:"text","onUpdate:modelValue":m=>r.factores[s].value=m,class:"block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 dark:text-gray-100 dark:bg-gray-700 dark:placeholder-gray-500 rounded-md shadow-sm text-base text-gray-900 bg-white placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:`Ingresa ${l.title.toLowerCase()}`},null,8,me),[[x,r.factores[s].value]])],2)]))),128)),a("div",ue,[a("div",pe,[fe,v(a("input",{type:"number",min:"0",max:"5","onUpdate:modelValue":o[1]||(o[1]=l=>r.factorSeleccionado=l),class:"block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-base text-gray-900 dark:text-gray-100 bg-white dark:bg-gray-700 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"},null,512),[[x,r.factorSeleccionado,void 0,{number:!0}]])])])]),f(O,{initialItems:n(t).items.length,onUpdateItems:d,class:""},null,8,["initialItems"]),(c(!0),p(h,null,y(n(t).items,(l,s)=>(c(),C(R,{key:l.id,item:l,indexItem:s,mostrarDetalles:r.mostrarDetalles,plantilla:i.plantilla,CallOnce_Plantilla:r.CallOnce_Plantilla,factores:r.factores,factorSeleccionado:r.factorSeleccionado,onUpdateItem:S,onUpd_itemname:z,onCheckzero:b,onDeleteItem:D,onCallOne_planti:N,class:"mb-4"},null,8,["item","indexItem","mostrarDetalles","plantilla","CallOnce_Plantilla","factores","factorSeleccionado"]))),128)),f(Q,{errors:Object.values(e.$page.props.errors)},null,8,["errors"]),f(O,{initialItems:n(t).items.length,onUpdateItems:d,class:"text-center mx-auto w-fit"},null,8,["initialItems"]),a("section",ge,[a("div",he,[a("div",be,[_e,a("p",we,k(n(J)(n(t).ultra_valor_total,0,1)),1)])])]),ye,r.EquipsOnZero?w("",!0):(c(),C(G,{key:0,ruta:"Oferta.index",formProcessing:n(t).processing,onCreate:_,class:"mb-20 pb-10"},null,8,["ruta","formProcessing"]))],40,ne)])],64))}};export{Ze as default};
