import{T as L,l as R,k as G,f as p,o as d,a as u,b as a,g as w,d as J,c as y,u as c,F as b,p as x,x as k,G as I,t as O,w as K,e as Q,J as V,n as W}from"./app-BhGvptmL.js";import{T as X}from"./Toast-DwfMDwwm.js";/* empty css             *//* empty css                   */import{r as C,_ as Y}from"./Newitem-BWoElxws.js";import ee from"./CerrarYguardar-CkJn2v-6.js";import N from"./Add_Sub_items-D41dib_0.js";import te from"./formOferta-D9HQxmjU.js";import{n as oe,p as j,a as E}from"./global-Dn-lfq_U.js";import{_ as ae}from"./PrimaryButton-BkUg86Bs.js";import{E as le}from"./ErroresNuevaOferta-BPRT1ZWQ.js";/* empty css                                              */import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TextInput-XsIzkty-.js";import"./Add_Sub_equipos-BztWUKjl.js";import"./vue-select.es-CcZCZQ2N.js";import"./InputError-Ck0A_nV9.js";import"./PencilIcon-KSwtZsAy.js";import"./SecondaryButton-sXq2m4Kv.js";const re={class:"space-y-6"},se={key:0,class:"flex justify-center mt-6 mb-2"},ie={class:"grid grid-cols-1 sm:grid-cols-3 lg:grid-cols-6 gap-6 p-4"},ne=["for"],ce=["id","onUpdate:modelValue","placeholder"],de={class:"col-span-1 relative bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-300 ease-in-out overflow-hidden"},ue={class:"p-4"},me={class:"text-gray-600 body-font"},pe={class:"container mx-auto"},fe={class:"flex flex-col text-center mx-auto w-full max-w-[300px] bg-white py-4 mt-12 mb-20 rounded-xl border border-collapse border-green-400"},ge={class:"text-2xl lg:w-2/3 mx-auto leading-relaxed"},be={class:"flex justify-center text-center my-4"},ze={__name:"NuevaOferta",props:{numberPermissions:Number,ultimoIdMasUno:Number,plantilla:Number,ultimaCD:Number},setup(T){const m=T,e=L({dataOferta:{codigo_oferta:m.ultimaCD,descripcion:"DEMCO INGENIERÍA, es una empresa dinámica dedicada al diseño, construcción y puesta en servicio de subestaciones y tableros eléctricos en media y baja tensión, desarrollando proyectos con altas especificaciones en ingeniería, en alianza con reconocidas empresas del sector eléctrico. Entregamos a nuestros clientes soluciones completas e integrales respaldados por procesos de ingeniería y automatización, ágiles y con importantes alianzas con reconocidas empresas del sector. Somos una empresa Colombiana con proyección hacia el futuro, contamos con productos de calidad, precios competitivos, recurso humano calificado, capacidad operativa y respuesta oportuna a nuestros cliente.",cargo:"ANALISTA DE OFERTA",empresa:"",ciudad:"",proyecto:""},equipos:[],daItems:[],valores_total_items:[],cantidadesItem:[],ultra_valor_total:0}),l=R({params:{pregunta:""},mostrarDetalles:!0,EquipsOnZero:!1,CallOnce_Plantilla:!0,hijosZeroFlags:{},factores:[{title:"Factor Suministro",value:1.33},{title:"Factor MT",value:1.5},{title:"Factor BT",value:1.6},{title:"Factor Cobre",value:1.55},{title:"Factor por Ingenieria Adicional",value:1}],factorSeleccionado:1});G(()=>{m.plantilla==="1"&&(C(e,0),e.dataOferta.ciudad="ciudad ejemplo",e.dataOferta.proyecto="proyecto ejemplo"),m.plantilla==="2"&&(C(e,1,1),e.dataOferta.empresa="empresa ejemplo",e.dataOferta.empresa="empresa eje superadmin",e.dataOferta.ciudad="ciudad eje superadmin",e.dataOferta.proyecto="proyecto eje superadmin")});function g(){e.ultra_valor_total=0,e.valores_total_items.forEach(o=>{e.ultra_valor_total+=o||0})}function F({equipos:o,valorItemUnitario:t,TotalItem:s,indexItem:r,cantidadItem:n,valor_total_item:i,daitem:H}){e.daItems[r]=H||{equipo_selec:null,cantidad:1},e.equipos[r]=o,e.valorItemUnitario=t,e.TotalItem=s;let _=0;o.forEach(f=>{f.equipo_selec&&(_=f.cantidad*f.equipo_selec.precio_de_lista,f.subtotalequip)}),r>=e.valores_total_items.length&&(e.valores_total_items.length=r+1),e.cantidadesItem[r]=n,e.valores_total_items[r]=i||0,g()}function S(o){e.daItems.splice(o,1),e.equipos.splice(o,1),e.valores_total_items.splice(o,1),e.cantidadesItem.splice(o,1),g()}function h(o){for(;e.daItems.length<o;)e.daItems.push({equipo_selec:null,cantidad:1}),e.equipos=j(e.equipos),l.hijosZeroFlags=j(l.hijosZeroFlags),e.valores_total_items.push(1),e.cantidadesItem.push();for(;e.daItems.length>o;)e.daItems.pop(),e.equipos=E(e.equipos),l.hijosZeroFlags=E(l.hijosZeroFlags),e.valores_total_items.pop(),e.cantidadesItem.pop();g(),l.CallOnce_Plantilla=!1}function q({index:o,isZero:t}){l.hijosZeroFlags[o]=t,l.EquipsOnZero=Object.values(l.hijosZeroFlags).includes(!0)}function D(){m.numberPermissions>9&&P();const o=document.querySelectorAll('[id^="valor-nulo"]');if(o.length===0){window.scrollTo(0,document.body.scrollHeight);return}for(const t of o)if(t.offsetParent!==null){t.scrollIntoView({behavior:"smooth",block:"center"});break}}function z(){const o=Array.from(document.querySelectorAll('[id^="itemN"]'));let t=-1;const s=window.innerHeight;o.forEach((r,n)=>{const i=r.getBoundingClientRect();console.log("🚀 ~ scrollToNextItem ~ rect.top: ",i.top),console.log("🚀 ~ scrollToNextItem ~ rect.bottom: ",i.bottom),i.bottom>0&&i.top<s&&(t=n)}),t>=0&&t<o.length-1&&o[t+1].scrollIntoView({behavior:"smooth",block:"center"})}function A(){const o=Array.from(document.querySelectorAll('[id^="itemN"]'));let t=-1;const s=window.innerHeight;o.forEach((r,n)=>{const i=r.getBoundingClientRect();console.log("🚀 ~ scrollToNextItem ~ rect.top: ",i.top),console.log("🚀 ~ scrollToNextItem ~ rect.bottom: ",i.bottom),i.bottom>0&&i.top<s&&(t=n)}),t>=0&&t<o.length-1&&t>0?o[t-1].scrollIntoView({behavior:"smooth",block:"center"}):window.scrollTo(0,0)}function P(){V.forEach(e.equipos,o=>{V.forEach(o,t=>{t&&t.equipo_selec&&(t.equipo_selec.precio_de_lista==0||t.equipo_selec.precio_de_lista==null)&&(t.equipo_selec.precio_de_lista=111)})})}const U=["daItems","valores_total_items","cantidadesItem"],Z=["ultra_valor_total"];function $(){return!(!e.dataOferta.cargo||!e.dataOferta.empresa)}function B(){let o=!0;return Z.forEach(t=>{if(!e[t])return o=!1,o}),o}function M(){return U.forEach(o=>{if(e[o]){if(e[o].length===0)return!1}else return!1}),!0}const v=()=>{B()&&M()&&$()?e.post(route("GuardarNuevaOferta"),{preserveScroll:!0,onSuccess:()=>{},onError:()=>null,onFinish:()=>null}):console.log("Hay campos vacios")};return(o,t)=>(d(),p(b,null,[u(X,{flash:o.$page.props.flash},null,8,["flash"]),a("button",{onClick:D,class:"fixed top-4 left-4 z-50 bg-blue-500 hover:bg-blue-700 text-white font-bold py-3 px-3 rounded-full shadow-lg","aria-label":"Ir a Valor nulo!"},t[3]||(t[3]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 13l-3 3m0 0l-3-3m3 3V8m0 13a9 9 0 110-18 9 9 0 010 18z"})],-1)])),a("button",{onClick:z,class:"fixed top-24 left-4 z-50 bg-amber-500 hover:bg-orange-700 text-white font-bold py-3 px-3 rounded-full shadow-lg","aria-label":"Siguiente item"},t[4]||(t[4]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 13l-3 3m0 0l-3-3m3 3V8m0 13a9 9 0 110-18 9 9 0 010 18z"})],-1)])),a("button",{onClick:A,class:"fixed top-4 right-4 z-50 bg-blue-500 hover:bg-blue-700 text-white font-bold py-3 px-3 rounded-full shadow-lg","aria-label":"Anterior item"},t[5]||(t[5]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 11l3-3m0 0l3 3m-3-3v8m0-13a9 9 0 110 18 9 9 0 010-18z"})],-1)])),a("section",re,[l.mostrarDetalles?(d(),p("div",se,t[6]||(t[6]=[a("img",{src:"/demco-logo-ultimo.png",alt:"Logo Demco",class:"h-12"},null,-1)]))):w("",!0),a("form",{onSubmit:J(v,["prevent"]),class:"px-16 py-1 2xl:px-8 2xl:py-4 print-container"},[u(te,{modelValue:c(e).dataOferta,"onUpdate:modelValue":t[0]||(t[0]=s=>c(e).dataOferta=s),class:""},null,8,["modelValue"]),a("div",ie,[(d(!0),p(b,null,x(l.factores,(s,r)=>(d(),p("div",{key:r,class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-300 ease-in-out overflow-hidden"},[a("div",{class:W([{"bg-indigo-100":r==l.factorSeleccionado-1},"p-4"])},[a("label",{for:`factor-input-${r}`,class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},O(s.title),9,ne),k(a("input",{id:`factor-input-${r}`,type:"text","onUpdate:modelValue":n=>l.factores[r].value=n,class:"block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-base text-gray-900 dark:text-gray-100 bg-white dark:bg-gray-700 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:`Ingresa ${s.title.toLowerCase()}`},null,8,ce),[[I,l.factores[r].value]])],2)]))),128)),a("div",de,[a("div",ue,[t[7]||(t[7]=a("label",{class:"block font-semibold text-gray-700 dark:text-gray-300 mb-2"}," Factor seleccionado ",-1)),k(a("input",{type:"number",min:"0",max:"5","onUpdate:modelValue":t[1]||(t[1]=s=>l.factorSeleccionado=s),class:"block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-base text-gray-900 dark:text-gray-100 bg-white dark:bg-gray-700 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"},null,512),[[I,l.factorSeleccionado,void 0,{number:!0}]])])])]),u(N,{initialItems:c(e).daItems.length,onUpdateItems:h,class:""},null,8,["initialItems"]),(d(!0),p(b,null,x(c(e).daItems,(s,r)=>{var n;return d(),y(Y,{key:r,valorUnitario:((n=s.equipo_selec)==null?void 0:n.Valor_Unit)??0,initialCantidad:s.cantidad??1,daitem:s,indexItem:r,mostrarDetalles:l.mostrarDetalles,plantilla:m.plantilla,CallOnce_Plantilla:l.CallOnce_Plantilla,factores:l.factores,factorSeleccionado:l.factorSeleccionado,onUpdatiItems:F,onCheckzero:q,onDeleteItem:S,class:"mb-4"},null,8,["valorUnitario","initialCantidad","daitem","indexItem","mostrarDetalles","plantilla","CallOnce_Plantilla","factores","factorSeleccionado"])}),128)),u(le,{errors:Object.values(o.$page.props.errors)},null,8,["errors"]),u(N,{initialItems:c(e).daItems.length,onUpdateItems:h,class:"text-center mx-auto w-fit"},null,8,["initialItems"]),a("section",me,[a("div",pe,[a("div",fe,[t[8]||(t[8]=a("h1",{class:"sm:text-xl text-lg font-medium title-font mb-4 text-gray-900"}," Valor total de la oferta ",-1)),a("p",ge,O(c(oe)(c(e).ultra_valor_total,0,1)),1)])])]),t[10]||(t[10]=a("hr",{class:"border-[1px] border-black my-8 col-span-full"},null,-1)),a("div",be,[u(ae,{type:"button",class:"px-4 py-2 rounded-2xl",onClick:t[2]||(t[2]=s=>l.mostrarDetalles=!l.mostrarDetalles)},{default:K(()=>t[9]||(t[9]=[Q(" Alternar detalles ")])),_:1,__:[9]})]),l.EquipsOnZero?w("",!0):(d(),y(ee,{key:0,ruta:"Oferta.index",formProcessing:c(e).processing,onCreate:v,class:"mb-20 pb-10"},null,8,["formProcessing"]))],32)])],64))}};export{ze as default};
