import{k as J,T as X,C as H,x as K,l as O,f as n,a as r,w as R,o as c,b as s,t as v,u as o,g as p,d as F,n as Q,e as W}from"./app-c2754de5.js";import{_ as u}from"./InputError-f0dfe909.js";import{_ as j,a as f}from"./TextInput-05cac8ef.js";import{_ as Y,a as Z}from"./SecondaryButton-2a5bdb7b.js";import{_ as ee}from"./PrimaryButton-9e8af232.js";import{C as b}from"./vue-select-bb897b0b.js";import"./vue-datepicker-25a82099.js";import{L as T}from"./global-16c20635.js";const oe={class:"space-y-6"},ae={class:"text-lg font-medium text-gray-900 dark:text-gray-100"},ie={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:grid-cols-4 gap-6"},te={key:0,id:"opcinesActividadO",class:"xl:col-span-2 col-span-1"},de=s("label",{name:""}," Reportar en nombre de: ",-1),le={id:"opcinesActividadO",class:"xl:col-span-2 col-span-1"},re=s("label",{name:""}," Tipo de reporte ",-1),se={class:"xl:col-span-1 col-span-1"},ne={class:"col-span-1"},ce={key:1,id:"Sordentrabajo",class:"xl:col-span-2 col-span-1"},pe=s("label",{name:"ordentrabajo_ids"}," Orden de trabajo ",-1),me={key:2,class:"w-full lg:col-span-2 col-span-1"},_e={key:3,class:"w-full col-span-1"},ue={id:"Scentrotrabajo",class:"col-span-1"},be=s("label",{name:"centrotrabajo_id"}," Centro de trabajo ",-1),ve={key:4,class:"col-span-1"},ge={key:5,id:"Sactividad",class:"xl:col-span-2 col-span-1"},je=s("label",{name:"label_actividad_id"}," Actividad ",-1),fe={key:6,id:"Sreproceso",class:"xl:col-span-2 col-span-1"},Te=s("label",{name:"reproceso_id"}," Reproceso",-1),he={key:7,id:"Sdisponibilidad",class:"xl:col-span-3 col-span-1"},ye=s("label",{name:"disponibilidad_id"}," Disponibilidad",-1),Ve={class:"mb-8 mt-[360px] flex justify-end"},xe={key:0,class:"mx-12 px-8 text-lg font-medium text-red-600 bg-red-50 dark:text-gray-100"},Oe={key:1,class:"mx-12 px-8 text-lg font-medium text-gray-800 dark:text-gray-100"},Ue={__name:"Edit",props:{show:Boolean,title:String,generica:Object,losSelect:Object,numberPermissions:Number,valuesGoogleCabeza:Object,valuesGoogleBody:Object,Trabajadores:Object},emits:["close"],setup(G,{emit:h}){const t=G,k=[{title:"Actividad",value:0},{title:"Reproceso",value:1},{title:"Disponibilidad(paro)",value:2}],y=["Nombre Tablero","% avance","OT+Item","Tiempo estimado"],V=["Nombre_tablero","avance"],d=J({params:{pregunta:""},actividad_id:t.losSelect.actividad,centrotrabajo_id:t.losSelect.centrotrabajo,disponibilidad_id:t.losSelect.disponibilidad,ordentrabajo_id:t.losSelect.ordentrabajo,ordenTemporal:[],reproceso_id:t.losSelect.reproceso,temp_disponibilidad_id:null,temp_reproceso_id:null,temp_actividad_id:null,valorInactivo:"NA",cabeza:t.valuesGoogleCabeza,nombresOT:Object.values(t.valuesGoogleBody),ordentrabajo_ids:[],mensajeFalta:"",BanderaTipo:!0,mensajeTiemposAuto:"",soloUnaVez:!0}),e=X({...Object.fromEntries(["tipoReporte","fecha","hora_inicial","hora_final","actividad_id","centrotrabajo_id","disponibilidad_id","operario_id","ordentrabajo_id","reproceso_id","ordentrabajo_ids","otitem","user_id","nombreTablero","OTItem","TiempoEstimado"].map(a=>[a,""]))});H(()=>{t.numberPermissions>9});const S=["Tiempo_estimado_corte","Tiempo_estimado_doblez","Tiempo_estimado_soldadura","Tiempo_estimado_pulida","Tiempo_estimado_ensamble","Tiempo_estimado_cobre","Tiempo_estimado_cableado","Tiempo_estimado_Ing_mec","Tiempo_estimado_Ing_elec"];K(()=>{if(t.show){if(e.errors={},e.ordentrabajo_ids&&e.ordentrabajo_ids.value!=null){e.nombreTablero=d.nombresOT[e.ordentrabajo_ids.value][V[0]],e.OTItem=d.nombresOT[e.ordentrabajo_ids.value].Item;let a=e.centrotrabajo_id.value-1;e.TiempoEstimado=d.nombresOT[e.ordentrabajo_ids.value][S[a]]}}else d.BanderaTipo=!0});let x=a=>{let i="";try{a.forEach((l,g)=>{if(typeof e[l]>"u"||e[l]===null||e[l].length===0)throw i=l,new Error("BreakException")})}catch{}return i},M=()=>{let a=e.tipoReporte.value,i=!0;const l=" es obligatorio";a==0&&(i=x(["ordentrabajo_ids","centrotrabajo_id","actividad_id"])),a==1&&(i=x(["centrotrabajo_id","ordentrabajo_ids","actividad_id","reproceso_id"])),a==2&&(i=x(["centrotrabajo_id","disponibilidad_id"]));let g={ordentrabajo_ids:"Orden trabajo",actividad_id:"Actividad",reproceso_id:"Reproceso",centrotrabajo_id:"Centro de trabajo",disponibilidad_id:"Disponibilidad"};return i!=""?g[i]+l:i};const q=()=>{var i;e.ordentrabajo_id=e.ordentrabajo_ids,console.log("ðŸ§ˆ debu form.tipoReporte.value:",e.tipoReporte.value),d.mensajeFalta=M();let a;a=T(t.losSelect.centrotrabajo,e.centrotrabajo_id),e.centrotrabajo_id=a!=""?a:"",e.tipoReporte.value===0&&(a=T(t.losSelect.actividad,e.actividad_id),e.actividad_id=a!=""?a:""),e.tipoReporte.value===1&&(a=T(t.losSelect.actividad,e.actividad_id),e.actividad_id=a!=""?a:"",a=T(t.losSelect.reproceso,e.reproceso_id),e.reproceso_id=a!=""?a:""),e.tipoReporte.value===2&&(a=T(t.losSelect.disponibilidad,e.disponibilidad_id),e.disponibilidad_id=a!=""?a:""),d.mensajeFalta==""&&e.put(route("reporte.update",(i=t.generica)==null?void 0:i.id),{preserveScroll:!0,onSuccess:()=>{h("close"),e.reset()},onError:()=>alert(JSON.stringify(e.errors,null,4)),onFinish:()=>null})};return O(()=>e.ordentrabajo_ids,a=>{d.soloUnaVez=!0,e.tipoReporte.value!==2&&e.ordentrabajo_ids?(d.tempCentro=e.centrotrabajo_id.value-1,e.TiempoEstimado=d.nombresOT[e.ordentrabajo_ids.value][S[d.tempCentro]]):console.log(e.ordentrabajo_ids)}),O(()=>t.show,()=>{var a,i,l,g,w,C,E,I,B,N,U,A,z,D;if(d.BanderaTipo){d.BanderaTipo=!1,e.tipoReporte=k[(a=t.generica)==null?void 0:a.tipoReporte],d.ordentrabajo_ids=d.nombresOT.map((_,m)=>{var $;return{title:($=_.Item)==null?void 0:$.replace(/_/g," "),value:m}}),d.ordenTemporal=d.nombresOT.map((_,m)=>({value:m,valueID:_.id}));let P=d.ordenTemporal.findIndex(_=>{var m;return _.valueID==((m=t.generica)==null?void 0:m.ordentrabajo_id)});e.ordentrabajo_ids=d.ordentrabajo_ids[P],e.centrotrabajo_id=d.centrotrabajo_id[(i=t.generica)==null?void 0:i.centrotrabajo_id],e.actividad_id=d.actividad_id[(l=t.generica)==null?void 0:l.actividad_id]?d.actividad_id[(g=t.generica)==null?void 0:g.actividad_id]:null,e.disponibilidad_id=d.disponibilidad_id[(w=t.generica)==null?void 0:w.disponibilidad_id]?d.disponibilidad_id[(C=t.generica)==null?void 0:C.disponibilidad_id]:null,e.reproceso_id=d.reproceso_id[(E=t.generica)==null?void 0:E.reproceso_id]?d.reproceso_id[(I=t.generica)==null?void 0:I.reproceso_id]:null,e.cantidad=(B=t.generica)==null?void 0:B.cantidad,e.fecha=(N=t.generica)==null?void 0:N.fecha,e.hora_inicial=(U=t.generica)==null?void 0:U.hora_inicial;let L=t.Trabajadores.findIndex(_=>{var m;return _.value==((m=t.generica)==null?void 0:m.operario_id)});e.user_id=t.Trabajadores[L],e.nombreTablero=(A=t.generica)==null?void 0:A.nombreTablero,e.OTItem=(z=t.generica)==null?void 0:z.OTItem,e.TiempoEstimado=(D=t.generica)==null?void 0:D.TiempoEstimado}else d.BanderaTipo=!t.show}),O(()=>e.centrotrabajo_id,(a,i)=>{if(a&&typeof a.value<"u"){let l="centrotrabajo"+a.title;d.actividad_id=t.losSelect[l],a.value!==t.generica.centrotrabajo_id&&(e.actividad_id={title:"Seleccione actividad",value:null})}}),(a,i)=>(c(),n("section",oe,[r(Y,{show:t.show,onClose:i[12]||(i[12]=l=>(h("close"),d.BanderaTipo=!0))},{default:R(()=>[s("form",{class:"px-6 my-8",onSubmit:i[11]||(i[11]=W((...l)=>a.create&&a.create(...l),["prevent"]))},[s("h2",ae,v(a.lang().label.edit)+" "+v(t.title),1),s("div",ie,[t.numberPermissions>8?(c(),n("div",te,[de,r(o(b),{options:t.Trabajadores,disabled:"",label:"title",modelValue:o(e).user_id,"onUpdate:modelValue":i[0]||(i[0]=l=>o(e).user_id=l)},null,8,["options","modelValue"])])):p("",!0),s("div",le,[re,r(o(b),{options:k,label:"title",disabled:"",modelValue:o(e).tipoReporte,"onUpdate:modelValue":i[1]||(i[1]=l=>o(e).tipoReporte=l)},null,8,["modelValue"])]),s("div",se,[r(j,{for:"fecha",value:a.lang().label.fecha},null,8,["value"]),r(f,{id:"fecha",type:"date",class:"mt-1 block w-full bg-gray-200",modelValue:o(e).fecha,"onUpdate:modelValue":i[2]||(i[2]=l=>o(e).fecha=l),disabled:"",placeholder:"fecha",error:o(e).errors.fecha},null,8,["modelValue","error"]),r(u,{class:"mt-2",message:o(e).errors.fecha},null,8,["message"])]),s("div",ne,[r(j,{for:"hora_inicial",value:a.lang().label["hora inicial"]},null,8,["value"]),r(f,{id:"hora_inicial",type:"time",class:"mt-1 block w-full bg-gray-200",modelValue:o(e).hora_inicial,"onUpdate:modelValue":i[3]||(i[3]=l=>o(e).hora_inicial=l),placeholder:"hora_inicial",error:o(e).errors.hora_inicial,step:"60"},null,8,["modelValue","error"]),r(u,{class:"mt-2",message:o(e).errors.hora_inicial},null,8,["message"])]),o(e).tipoReporte.value!=2?(c(),n("div",ce,[pe,r(o(b),{options:d.ordentrabajo_ids,label:"title",modelValue:o(e).ordentrabajo_ids,"onUpdate:modelValue":i[4]||(i[4]=l=>o(e).ordentrabajo_ids=l)},null,8,["options","modelValue"]),r(u,{class:"mt-2",message:o(e).errors.ordentrabajo_id},null,8,["message"])])):p("",!0),o(e).ordentrabajo_ids&&o(e).tipoReporte.value!=2?(c(),n("div",me,[r(j,{for:"index",value:y[0]},null,8,["value"]),r(f,{id:"index",type:"text",disabled:"",class:"mt-1 block w-full bg-gray-200",value:d.nombresOT[o(e).ordentrabajo_ids.value][V[0]]},null,8,["value"])])):p("",!0),o(e).ordentrabajo_ids&&o(e).tipoReporte.value!=2?(c(),n("div",_e,[r(j,{for:"index",value:y[1]},null,8,["value"]),r(f,{id:"index",type:"text",disabled:"",class:"mt-1 block w-full bg-gray-200",value:d.nombresOT[o(e).ordentrabajo_ids.value][V[1]]},null,8,["value"])])):p("",!0),s("div",ue,[be,r(o(b),{options:d.centrotrabajo_id,label:"title",modelValue:o(e).centrotrabajo_id,"onUpdate:modelValue":i[5]||(i[5]=l=>o(e).centrotrabajo_id=l)},null,8,["options","modelValue"]),r(u,{class:"mt-2",message:o(e).errors.centrotrabajo_id},null,8,["message"])]),o(e).ordentrabajo_ids&&o(e).centrotrabajo_id&&o(e).tipoReporte.value!=2?(c(),n("div",ve,[r(j,{for:"index",value:y[3]},null,8,["value"]),r(f,{id:"index",type:"text",disabled:"",class:"mt-1 block w-full bg-gray-200",modelValue:o(e).TiempoEstimado,"onUpdate:modelValue":i[6]||(i[6]=l=>o(e).TiempoEstimado=l)},null,8,["modelValue"])])):p("",!0),o(e).tipoReporte.value==0||o(e).tipoReporte.value==1?(c(),n("div",ge,[je,r(o(b),{options:d.actividad_id,label:"title",required:"",modelValue:o(e).actividad_id,"onUpdate:modelValue":i[7]||(i[7]=l=>o(e).actividad_id=l)},null,8,["options","modelValue"]),r(u,{class:"mt-2",message:o(e).errors.actividad_id},null,8,["message"])])):p("",!0),o(e).tipoReporte.value==1?(c(),n("div",fe,[Te,r(o(b),{options:d.reproceso_id,label:"title",required:"",modelValue:o(e).reproceso_id,"onUpdate:modelValue":i[8]||(i[8]=l=>o(e).reproceso_id=l)},null,8,["options","modelValue"]),r(u,{class:"mt-2",message:o(e).errors.reproceso_id},null,8,["message"])])):p("",!0),o(e).tipoReporte.value==2?(c(),n("div",he,[ye,r(o(b),{options:d.disponibilidad_id,label:"title",required:"",modelValue:o(e).disponibilidad_id,"onUpdate:modelValue":i[9]||(i[9]=l=>o(e).disponibilidad_id=l)},null,8,["options","modelValue"]),r(u,{class:"mt-2",message:o(e).errors.disponibilidad_id},null,8,["message"])])):p("",!0)]),s("div",Ve,[d.mensajeFalta!=""?(c(),n("h2",xe,v(d.mensajeFalta),1)):p("",!0),d.mensajeTiemposAuto!=""?(c(),n("h2",Oe,v(d.mensajeTiemposAuto),1)):p("",!0),r(Z,{disabled:o(e).processing,onClick:i[10]||(i[10]=l=>h("close"))},{default:R(()=>[F(v(a.lang().button.close),1)]),_:1},8,["disabled"]),r(ee,{class:Q(["ml-3",{"opacity-25":o(e).processing}]),disabled:o(e).processing,onClick:q},{default:R(()=>[F(v(o(e).processing?a.lang().button.save+"...":a.lang().button.save),1)]),_:1},8,["class","disabled"])])],32)]),_:1},8,["show"])]))}};export{Ue as default};
