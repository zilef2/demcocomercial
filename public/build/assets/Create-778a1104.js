import{k as D,T as E,C as N,x as B,l as V,f as n,a as l,w as h,o as c,b as d,t as _,u as a,g as u,d as j,n as $,e as U}from"./app-139f33ef.js";import{_ as p}from"./InputError-2106c1ba.js";import{_ as b,a as f}from"./TextInput-1f7b1279.js";import{_ as M,a as H}from"./SecondaryButton-97ec605f.js";import{_ as F}from"./PrimaryButton-eb9a6b88.js";import{C as m}from"./vue-select-9665fba6.js";/* empty css             */import{T as z,a as T,D as G}from"./global-70cc1b90.js";const q={class:"space-y-6 dark:text-white"},I=["onSubmit"],P={class:"text-lg font-medium text-gray-900 dark:text-white"},J={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:grid-cols-4 gap-6"},L={key:0,id:"opcinesActividadO",class:"xl:col-span-2 col-span-1"},W=d("label",{class:"dark:text-white",name:""},[j(" Reportar en nombre de: "),d("small",null,"(Opcional) ")],-1),X={id:"opcinesActividadO",class:"xl:col-span-2 col-span-1"},K=d("label",{class:"dark:text-white"}," Tipo de reporte ",-1),Q={class:"xl:col-span-1 col-span-1"},Y={class:"dark:text-white col-span-1"},Z={key:1,id:"Sordentrabajo",class:"xl:col-span-2 col-span-1"},ee=d("label",{name:"ordentrabajo_ids",class:"dark:text-white"}," NÃºmero de oferta ",-1),ae={key:2,class:"w-full lg:col-span-2 col-span-1 dark:text-white"},oe={key:3,class:"w-full col-span-1 dark:text-white"},te={id:"Scentrotrabajo",class:"col-span-1"},ie=d("label",{name:"centrotrabajo_id",class:"dark:text-white"}," Centro de trabajo ",-1),le={key:4,class:"col-span-1 dark:text-white"},se={key:5,id:"actividad",class:"xl:col-span-2 col-span-1"},de=d("label",{name:"actividad_id",class:"dark:text-white"}," Actividad ",-1),re={key:6,id:"reproceso",class:"xl:col-span-2 col-span-1"},ne=d("label",{name:"reproceso_id",class:"dark:text-white"}," Reproceso",-1),ce={key:7,id:"disponibilidad",class:"xl:col-span-3 col-span-1"},ue=d("label",{name:"disponibilidad_id",class:"dark:text-white"}," Disponibilidad",-1),pe={class:"mb-8 mt-[360px] flex justify-end"},me={key:0,class:"mx-12 px-8 text-lg font-medium text-red-600 bg-red-50 dark:text-white dark:bg-gray-800"},_e={key:1,class:"mx-12 px-8 text-lg font-medium text-gray-800 dark:text-white dark:bg-gray-800"},we={__name:"Create",props:{show:Boolean,title:String,roles:Object,losSelect:Object,numberPermissions:Number,valuesGoogleCabeza:Object,valuesGoogleBody:Object,Trabajadores:Object},emits:["close"],setup(C,{emit:g}){const r=C,s=D({params:{pregunta:""},actividad_id:r.losSelect.actividad,centrotrabajo_id:r.losSelect.centrotrabajo,disponibilidad_id:r.losSelect.disponibilidad,ordentrabajo_id:r.losSelect.ordentrabajo,reproceso_id:r.losSelect.reproceso,temp_disponibilidad_id:null,temp_reproceso_id:null,temp_actividad_id:null,valorInactivo:"NA",cabeza:r.valuesGoogleCabeza,nombresOT:Object.values(r.valuesGoogleBody),ordentrabajo_ids:[],mensajeFalta:"",BanderaTipo:!0,mensajeTiemposAuto:"",limiteMinimo:""}),e=E({...Object.fromEntries(["tipoReporte","fecha","hora_inicial","hora_final","actividad_id","centrotrabajo_id","disponibilidad_id","operario_id","ordentrabajo_id","reproceso_id","ordentrabajo_ids","otitem","user_id","numero_oferta","OTItem","TiempoEstimado"].map(i=>[i,""]))}),k=()=>{let i=new Date;i.setHours(i.getHours()-1);let o=t=>t<10?`0${t}`:t;return`${o(i.getHours())}:${o(i.getMinutes())}`},O=i=>(i.preventDefault(),!1);N(()=>{s.limiteMinimo=k(),setInterval(()=>{s.limiteMinimo=k()},6e4),document.body.addEventListener("contextmenu",O),s.ordentrabajo_ids=s.nombresOT.map((i,o)=>{var t;return{title:(t=i.numero_oferta)==null?void 0:t.replace(/_/g," "),value:i.id}})});let v=i=>{let o="";try{i.forEach((t,y)=>{if(typeof e[t]>"u"||e[t]===null||e[t].value===null||e[t].length===0)throw o=t,new Error("BreakException")})}catch{}return o},R=()=>{let i=e.tipoReporte.value,o=!0;const t=". Campo obligatorio";let y=new Date().getHours(),w=G(y+":00",e.hora_inicial);if(console.log(w),w>0)return"Ha pasado mucho tiempo!";i===0&&(o=v(["ordentrabajo_ids","centrotrabajo_id","actividad_id"])),i===1&&(o=v(["centrotrabajo_id","ordentrabajo_ids","actividad_id","reproceso_id"])),i===2&&(o=v(["centrotrabajo_id","disponibilidad_id"]));let A={ordentrabajo_ids:"Orden trabajo",actividad_id:"Actividad",reproceso_id:"Reproceso",centrotrabajo_id:"Centro de trabajo",disponibilidad_id:"Disponibilidad"};return o!==""?A[o]+t:o};B(()=>{var i;if(r.show){if(s.BanderaTipo&&(e.tipoReporte={title:"Actividad",value:0},s.BanderaTipo=!1),e.errors={},e.fecha===null||e.fecha===""){let o=new Date;e.fecha=z(o).substring(0,10),e.hora_inicial=T()}if((i=e.ordentrabajo_ids)!=null&&i.value){console.table(s.nombresOT.slice(0,10));let o=s.nombresOT.find(t=>(console.log("=>(Create.vue:211) item",t),console.log("=>(Create.vue:213) form['ordentrabajo_ids'].value",e.ordentrabajo_ids.value),t.id===e.ordentrabajo_ids.value));console.log("=>(Create.vue:211) asd",o),e.avance=o.avance,e.cliente=o.cliente,e.TiempoEstimado=o.tiempo_estimado}}else s.BanderaTipo=!0}),V(()=>e.tipoReporte,i=>{e.actividad_id=null,e.centrotrabajo_id=null,e.disponibilidad_id=null,e.operario_id=null,e.ordentrabajo_id=null,e.reproceso_id=null,e.ordentrabajo_ids=null,e.numero_oferta=null,e.TiempoEstimado=null}),V(()=>e.centrotrabajo_id,i=>{if(i&&typeof i.value<"u"){let o="centrotrabajo"+i.title;s.actividad_id=r.losSelect[o]}e.actividad_id={title:"Seleccione actividad",value:null}});const x=()=>{e.ordentrabajo_id=e.ordentrabajo_ids,s.mensajeFalta=R(),e.hora_inicial=T(),s.mensajeFalta===""&&setTimeout(e.post(route("reporte.store"),{preserveScroll:!0,onSuccess:()=>{g("close"),e.reset()},onError:()=>alert(JSON.stringify(e.errors,null,4)),onFinish:()=>null}),200)},S=[{title:"Actividad",value:0},{title:"Reproceso",value:1},{title:"Disponibilidad (paro)",value:2}];return(i,o)=>(c(),n("section",q,[l(M,{show:r.show,onClose:o[11]||(o[11]=t=>g("close")),maxWidth:"4xl"},{default:h(()=>[d("form",{class:"px-6 my-8",onSubmit:U(x,["prevent"])},[d("h2",P,_(i.lang().label.add)+" "+_(r.title),1),d("div",J,[r.numberPermissions>1?(c(),n("div",L,[W,l(a(m),{options:r.Trabajadores,label:"title",class:"dark:bg-gray-400",modelValue:a(e).user_id,"onUpdate:modelValue":o[0]||(o[0]=t=>a(e).user_id=t)},null,8,["options","modelValue"])])):u("",!0),d("div",X,[K,l(a(m),{options:S,label:"title",class:"dark:bg-gray-400",modelValue:a(e).tipoReporte,"onUpdate:modelValue":o[1]||(o[1]=t=>a(e).tipoReporte=t)},null,8,["modelValue"])]),d("div",Q,[l(b,{for:"fecha",value:i.lang().label.fecha,class:"dark:text-white"},null,8,["value"]),l(f,{id:"fecha",type:"date",class:"mt-1 block w-full bg-gray-200 dark:text-white",modelValue:a(e).fecha,"onUpdate:modelValue":o[2]||(o[2]=t=>a(e).fecha=t),disabled:"",placeholder:"fecha",error:a(e).errors.fecha},null,8,["modelValue","error"]),l(p,{class:"mt-2",message:a(e).errors.fecha},null,8,["message"])]),d("div",Y,[l(b,{for:"hora_inicial",value:i.lang().label["hora inicial"]},null,8,["value"]),l(f,{id:"hora_inicial",type:"time",class:"mt-1 block w-full",disabled:"",modelValue:a(e).hora_inicial,"onUpdate:modelValue":o[3]||(o[3]=t=>a(e).hora_inicial=t),placeholder:"hora_inicial",error:a(e).errors.hora_inicial,step:"60"},null,8,["modelValue","error"]),l(p,{class:"mt-2",message:a(e).errors.hora_inicial},null,8,["message"])]),a(e).tipoReporte.value!==2?(c(),n("div",Z,[ee,l(a(m),{options:s.ordentrabajo_ids,label:"title",class:"dark:bg-gray-400",modelValue:a(e).ordentrabajo_ids,"onUpdate:modelValue":o[4]||(o[4]=t=>a(e).ordentrabajo_ids=t)},null,8,["options","modelValue"]),l(p,{class:"mt-2",message:a(e).errors.ordentrabajo_id},null,8,["message"])])):u("",!0),a(e).ordentrabajo_ids&&a(e).tipoReporte.value!==2?(c(),n("div",ae,[l(b,{for:i.index,value:"Cliente",class:""},null,8,["for"]),l(f,{id:i.index,type:"text",disabled:"",class:"mt-1 block w-full bg-gray-200",value:a(e).cliente},null,8,["id","value"])])):u("",!0),a(e).ordentrabajo_ids&&a(e).tipoReporte.value!==2?(c(),n("div",oe,[l(b,{for:i.index,value:"% avance"},null,8,["for"]),l(f,{id:i.index,type:"text",disabled:"",class:"mt-1 block w-full bg-gray-200",value:a(e).avance},null,8,["id","value"])])):u("",!0),d("div",te,[ie,l(a(m),{options:s.centrotrabajo_id,label:"title",class:"dark:bg-gray-400",modelValue:a(e).centrotrabajo_id,"onUpdate:modelValue":o[5]||(o[5]=t=>a(e).centrotrabajo_id=t)},null,8,["options","modelValue"]),l(p,{class:"mt-2",message:a(e).errors.centrotrabajo_id},null,8,["message"])]),a(e).ordentrabajo_ids&&a(e).centrotrabajo_id&&a(e).tipoReporte.value!==2?(c(),n("div",le,[l(b,{for:i.index,value:"Tiempo estimado"},null,8,["for"]),l(f,{id:i.index,type:"text",disabled:"",class:"mt-1 block w-full bg-gray-200 dark:bg-gray-400 dark:text-white",modelValue:a(e).TiempoEstimado,"onUpdate:modelValue":o[6]||(o[6]=t=>a(e).TiempoEstimado=t)},null,8,["id","modelValue"])])):u("",!0),a(e).tipoReporte.value==0||a(e).tipoReporte.value==1?(c(),n("div",se,[de,l(a(m),{options:s.actividad_id,label:"title",required:"",modelValue:a(e).actividad_id,"onUpdate:modelValue":o[7]||(o[7]=t=>a(e).actividad_id=t),class:"dark:bg-gray-400"},null,8,["options","modelValue"]),l(p,{class:"mt-2",message:a(e).errors.actividad_id},null,8,["message"])])):u("",!0),a(e).tipoReporte.value==1?(c(),n("div",re,[ne,l(a(m),{options:s.reproceso_id,label:"title",required:"",modelValue:a(e).reproceso_id,"onUpdate:modelValue":o[8]||(o[8]=t=>a(e).reproceso_id=t),class:"dark:bg-gray-400"},null,8,["options","modelValue"]),l(p,{class:"mt-2",message:a(e).errors.reproceso_id},null,8,["message"])])):u("",!0),a(e).tipoReporte.value==2?(c(),n("div",ce,[ue,l(a(m),{options:s.disponibilidad_id,label:"title",required:"",modelValue:a(e).disponibilidad_id,"onUpdate:modelValue":o[9]||(o[9]=t=>a(e).disponibilidad_id=t),class:"dark:bg-gray-400"},null,8,["options","modelValue"]),l(p,{class:"mt-2",message:a(e).errors.disponibilidad_id},null,8,["message"])])):u("",!0)]),d("div",pe,[s.mensajeFalta!==""?(c(),n("h2",me,_(s.mensajeFalta),1)):u("",!0),s.mensajeTiemposAuto!==""?(c(),n("h2",_e,_(s.mensajeTiemposAuto),1)):u("",!0),l(H,{disabled:a(e).processing,onClick:o[10]||(o[10]=t=>g("close"))},{default:h(()=>[j(_(i.lang().button.close),1)]),_:1},8,["disabled"]),l(F,{class:$(["ml-3",{"opacity-25":a(e).processing}]),disabled:a(e).processing,onClick:x},{default:h(()=>[j(_(a(e).processing?i.lang().button.add+"...":i.lang().button.add),1)]),_:1},8,["class","disabled"])])],40,I)]),_:1},8,["show"])]))}};export{we as default};
