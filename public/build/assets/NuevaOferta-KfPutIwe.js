import{T as E,l as F,k as O,m as P,f as m,o as c,b as t,a as x,c as C,g as B,u as i,F as k,p as I,t as l,d as T,n as j}from"./app-Cq1znuMy.js";/* empty css             *//* empty css                   */import L from"./Newitem-BWTWw2n6.js";import V from"./CerrarYguardar-BKeXE5-l.js";import"./vue-select.es-wsHHmxmz.js";import D from"./Add_Sub_items-D29prGxw.js";import{n as N,f as M}from"./global-C5jYNk1l.js";import"./TextInput-CxVKhdog.js";import"./Add_Sub_equipos-h-xPCDm8.js";import"./PrimaryButton-C4YOsuaB.js";import"./SecondaryButton-BnrCYek9.js";const $={class:"space-y-6"},A={class:"text-gray-600 body-font"},R={class:"container mx-auto"},G={class:"flex flex-col text-center mx-auto w-full max-w-[300px] bg-white py-12 mt-12 mb-20 rounded-xl border border-collapse border-green-400"},H={class:"text-2xl lg:w-2/3 mx-auto leading-relaxed"},J={class:"w-full my-8 px-2 2xl:px-16 max-h-[330px] overflow-y-scroll no-print"},K={class:"overflow-x-auto"},Q={class:"w-full divide-y-2 divide-gray-200"},W={class:"px-3 py-2 whitespace-nowrap"},X={class:"px-3 py-2 whitespace-nowrap"},Y={class:"px-3 py-2 whitespace-nowrap"},Z={class:"px-3 py-2 whitespace-nowrap"},q={class:"px-3 py-2 whitespace-nowrap"},tt={class:"px-3 py-2 whitespace-nowrap"},et={class:"px-3 py-2 whitespace-nowrap"},at={class:"px-3 py-2 whitespace-nowrap"},_t={__name:"NuevaOferta",props:{show:Boolean,title:String,roles:Object,titulos:Object,losSelect:Object,numberPermissions:Number},setup(h){const u=h,e=E({codigo_oferta:"",descripcion:"",cargo:"",empresa:"",ciudad:"",proyecto:"",fecha:"",user_id:"",equipos:[],items:[],valores_total_items:[],cantidadesItem:[],ultra_valor_total:0}),f=F({params:{pregunta:""},mostrarDetalles:!0});O(()=>{u.numberPermissions>9}),P(()=>{u.show});function g(){e.ultra_valor_total=0,e.valores_total_items.forEach(o=>{e.ultra_valor_total+=o||0})}function S({equipos:o,valorItemUnitario:a,TotalItem:p,indexItem:s,cantidadItem:n,valor_total_item:d}){e.equipos[s]=o,e.valorItemUnitario=a,e.TotalItem=p;let b=0;o.forEach(r=>{r.equipo_selec&&(b=r.cantidad*r.equipo_selec.precio_de_lista,b!==r.subtotalequip&&(console.log("ðŸš€ ~ actualizarValoresItems ~ equipo.equipo_selec.precio_de_lista: ",r.equipo_selec),console.error("errorsini: cant, precio y total",r.cantidad,r.equipo_selec.precio_de_lista,r.subtotalequip)),console.log("CCCant, precio y total",r.cantidad,r.equipo_selec.precio_de_lista,r.subtotalequip))}),s>=e.valores_total_items.length&&(e.valores_total_items.length=s+1),e.cantidadesItem[s]=n,e.valores_total_items[s]=d||0,g()}function w(o){for(;e.items.length<o;)e.items.push({equipo_selec:null,cantidad:1});for(;e.items.length>o;)e.items.pop(),e.valores_total_items.pop();g()}const U=["items","valores_total_items","cantidadesItem"],z=["ultra_valor_total"];function y(){let o=!0;return z.forEach(a=>{if(!e[a])return console.log("=>(Create.vue:70) falta esto papa element",a),o=!1,o}),o}function v(){return U.forEach(o=>{if(e[o]){if(e[o].length===0)return console.log("=>(Create.vue:70) el vector esta vacio = ",o),!1}else return console.log("=>(Create.vue:70) el vector no existe = ",o),!1}),!0}const _=()=>{console.log(y()+" - "+v()),y()&&v()?e.post(route("GuardarNuevaOferta"),{preserveScroll:!0,onSuccess:()=>{e.reset()},onError:()=>null,onFinish:()=>null}):console.log("Hay campos vacios")};return(o,a)=>{var p;return c(),m("section",$,[a[6]||(a[6]=t("div",{class:"flex justify-center my-8"},[t("img",{src:"/demco-logo-ultimo.png",alt:"Logo Demco",class:"h-12"})],-1)),t("form",{onSubmit:T(_,["prevent"]),class:"px-16 py-4 2xl:px-36 2xl:pb-8 print-container"},[a[3]||(a[3]=t("div",{class:"flex flex-col text-center w-full mb-12"},[t("h1",{class:"sm:text-3xl text-2xl font-medium title-font mb-4 text-gray-900"},"Oferta"),t("p",{class:"lg:w-2/3 mx-auto leading-relaxed text-base no-print"},"Agrege tantos items necesite para la oferta")],-1)),x(D,{initialItems:i(e).items.length,onUpdateItems:w,class:"no-print"},null,8,["initialItems"]),a[4]||(a[4]=t("hr",{class:"border-[1px] border-black my-6 col-span-full"},null,-1)),t("button",{type:"button",class:"px-4 py-2 text-white bg-[#74bc1f] rounded-2xl no-print",onClick:a[0]||(a[0]=s=>f.mostrarDetalles=!f.mostrarDetalles)}," Alternar vista con/sin detalles "),(c(!0),m(k,null,I(i(e).items,(s,n)=>{var d;return c(),C(L,{key:n,valorUnitario:((d=s.equipo_selec)==null?void 0:d.Valor_Unit)??0,initialCantidad:s.cantidad??1,indexItem:n,losSelect:h.losSelect,mostrarDetalles:f.mostrarDetalles,onUpdatiItems:S},null,8,["valorUnitario","initialCantidad","indexItem","losSelect","mostrarDetalles"])}),128)),i(e).items.length>2?(c(),C(D,{key:0,initialItems:i(e).items.length,onUpdateItems:w,class:"no-print"},null,8,["initialItems"])):B("",!0),t("section",A,[t("div",R,[t("div",G,[a[1]||(a[1]=t("h1",{class:"sm:text-3xl text-2xl font-medium title-font mb-4 text-gray-900"}," Valor total de la oferta",-1)),t("p",H,l(i(N)(i(e).ultra_valor_total,0,1)),1)])])]),x(V,{ruta:"Oferta.index",formProcessing:i(e).processing,onCreate:_,class:"no-print"},null,8,["formProcessing"]),a[5]||(a[5]=t("h2",{class:"mx-auto text-center text-2xl font-medium text-gray-900 dark:text-gray-100 mt-36 no-print"}," Ãšltimas actualizaciones de equipos (Sin precio de lista) ",-1)),t("div",J,[t("div",K,[t("table",Q,[a[2]||(a[2]=t("thead",{class:"ltr:text-left rtl:text-right"},[t("tr",{class:"*:font-medium *:text-gray-900 *:first:sticky *:first:left-0 *:first:bg-white"},[t("th",{class:"px-3 py-2 whitespace-nowrap"},"CÃ³digo"),t("th",{class:"px-3 py-2 whitespace-nowrap"},"DescripciÃ³n"),t("th",{class:"px-3 py-2 whitespace-nowrap"},"Tipo Fabricante"),t("th",{class:"px-3 py-2 whitespace-nowrap"},"Referencia Fabricante"),t("th",{class:"px-3 py-2 whitespace-nowrap"},"Marca"),t("th",{class:"px-3 py-2 whitespace-nowrap"},"Unidad de Compra"),t("th",{class:"px-3 py-2 whitespace-nowrap"},"Precio de Lista"),t("th",{class:"px-3 py-2 whitespace-nowrap"},"Ãšltima ActualizaciÃ³n")])],-1)),(c(!0),m(k,null,I((p=u.losSelect)==null?void 0:p.ultimosEquipos,(s,n)=>(c(),m("tbody",{key:n,class:"divide-y divide-gray-200"},[t("tr",{class:j(["*:text-gray-900 *:first:sticky *:first:left-0 *:first:bg-white *:first:font-medium hover:bg-red-300 hover:dark:bg-gray-900/20",n%2===0?"bg-gray-200":"bg-white"])},[t("td",W,l(s.Codigo),1),t("td",X,l(s.Descripcion),1),t("td",Y,l(s["Tipo Fabricante"]),1),t("td",Z,l(s["Referencia Fabricante"]),1),t("td",q,l(s.Marca),1),t("td",tt,l(s["Unidad de Compra"]),1),t("td",et,l(i(N)(s["Precio de Lista"],0,1)),1),t("td",at,l(i(M)(s["Fecha actualizacion"])),1)],2)]))),128))])])]),x(V,{ruta:"Oferta.index",formProcessing:i(e).processing,onCreate:_,class:"no-print"},null,8,["formProcessing"])],32)])}}};export{_t as default};
