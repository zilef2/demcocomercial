import{k as C,K as U,p as E,O as T,q as z,f as d,a as c,u as p,w as _,F as h,s as A,o as r,Z as M,b as t,c as y,d as k,i as v,g as i,v as b,y as q,m as x,t as m,x as K,e as L}from"./app-551012d8.js";import{_ as Q}from"./AuthenticatedLayout-876c1694.js";import{_ as R}from"./Breadcrumb-f8dcf550.js";import{_ as Z}from"./TextInput-4b8270d6.js";import{_ as G}from"./PrimaryButton-bd076b11.js";import{_ as H}from"./DangerButton-1248510a.js";import{_ as J}from"./SelectInput-de862fb7.js";import{a as W,r as O,_ as X}from"./Pagination-dcee69fa.js";import Y from"./DeleteBulk-2a625ebb.js";import F from"./Delete-86b0d751.js";import{_ as ee}from"./Detalle.vue_vue_type_script_setup_true_lang-ae2ee412.js";import{_ as te}from"./Checkbox-f37bd788.js";import{n as $,f as P}from"./global-6d1c7c87.js";import{r as se}from"./PencilIcon-7035d21d.js";import"./index-6dbb85e0.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./open-closed-305ccb86.js";import"./Toast-07128877.js";/* empty css                                              */import"./Modal-e8455b5b.js";import"./SecondaryButton-ec5b0153.js";const re={class:"space-y-4"},ae={class:"px-4 sm:px-0"},oe={class:"rounded-lg overflow-hidden w-fit"},le={class:"relative bg-white dark:bg-gray-800 shadow sm:rounded-lg"},de={class:"flex justify-between p-2"},ne={class:"flex space-x-2"},ie={class:"overflow-x-auto scrollbar-table"},ce={key:0,class:"w-full"},pe={class:"uppercase text-sm border-t border-gray-200 dark:border-gray-700"},me={class:"dark:bg-gray-900/50 text-left"},fe={class:"px-2 py-4 text-center"},ue={key:0,class:"px-2 py-4"},_e=t("th",{class:"px-2 py-4 text-center"},"#",-1),ye=["onClick"],he={class:"flex justify-between items-center"},be={class:"px-2 py-4 cursor-pointer"},ge={class:"flex justify-between items-center"},ke=t("span",null,"Ver detalles",-1),xe={class:"whitespace-nowrap py-4 px-2 sm:py-3 text-center"},we=["value"],ve={key:0,class:"whitespace-nowrap py-4 w-12 px-2 sm:py-3"},Oe={class:"justify-center items-center"},$e={class:"inline-flex rounded-md shadow-sm",role:"group"},Pe={class:"flex items-center"},Se=t("span",null,"Editar",-1),De=["onClick"],Ie={class:"whitespace-nowrap py-4 px-2 sm:py-3 text-center"},Ve={class:"whitespace-nowrap py-4 px-2 sm:py-3"},je={key:0},Be={key:1},Ne={key:2},Ce={key:3},Ue={key:4},Ee={key:5},Te=["onClick"],ze={class:"border-t border-gray-600"},Ae={key:0,class:"whitespace-nowrap py-4 w-12 px-2 sm:py-3 text-center"},Me=t("td",{class:"whitespace-nowrap py-4 px-2 sm:py-3 text-center"}," Total:",-1),qe={class:"whitespace-nowrap py-4 px-2 sm:py-3 text-center"},Ke={key:1,class:"text-center text-xl my-8"},Le={key:0,class:"flex justify-between items-center p-2 border-t border-gray-200 dark:border-gray-700"},pt={__name:"Index",props:{fromController:Object,total:Number,filters:Object,breadcrumbs:Object,perPage:Number,title:String,numberPermissions:Number,losSelect:Object},setup(f){const n=f,{_:S,debounce:D,pickBy:I}=A,e=C({params:{search:n.filters.search,field:n.filters.field,order:n.filters.order,perPage:n.perPage},DetalleOpen:!1,eldetalle:null,Ofertao:null,selectedId:[],multipleSelect:!1,deleteOpen:!1,deleteBulkOpen:!1,dataSet:U().props.app.perpage}),V=a=>{e.params.field=a,e.params.order=e.params.order==="asc"?"desc":"asc"};E(()=>S.cloneDeep(e.params),D(()=>{let a=I(e.params);T.get(route("Oferta.index"),a,{replace:!0,preserveState:!0,preserveScroll:!0})},150));const j=a=>{var o;a.target.checked===!1?e.selectedId=[]:(o=n.fromController)==null||o.data.forEach(u=>{e.selectedId.push(u.id)})},B=()=>{var a;return e.multipleSelect=((a=n.fromController)==null?void 0:a.data.length)===e.selectedId.length},w=[{order:"codigo_oferta",label:"codigo_oferta",type:"text"},{order:"cliente",label:"Cliente",type:"text"},{order:"proyecto",label:"proyecto",type:"text"},{order:"TotalOferta",label:"TotalOferta",type:"dinero"},{order:"Userino",label:"user_id",type:"foreign",nameid:"Userino"},{order:"cargo",label:"cargo",type:"text"},{order:"empresa",label:"empresa",type:"text"},{order:"ciudad",label:"ciudad",type:"text"},{order:"fecha",label:"fecha",type:"date"}];function N(a){if(!a||!a.id){console.error("claseFromController no definido");return}window.open(route("Oferta.pdf",a.id),"_blank")}return(a,o)=>{const u=z("tooltip");return r(),d(h,null,[c(p(M),{title:n.title},null,8,["title"]),c(Q,null,{default:_(()=>[c(R,{title:f.title,breadcrumbs:f.breadcrumbs,class:"capitalize text-xl font-bold"},null,8,["title","breadcrumbs"]),t("div",re,[t("div",ae,[t("div",oe,[a.can(["create oferta"])?(r(),y(p(v),{key:0,class:"rounded-none",href:"/NuevaOferta/1"},{default:_(()=>[c(G,{class:"rounded-none"},{default:_(()=>[k(" Oferta plantilla 1")]),_:1})]),_:1})):i("",!0),a.can(["delete oferta"])?(r(),y(F,{key:1,numberPermissions:n.numberPermissions,show:e.deleteOpen,onClose:o[0]||(o[0]=s=>e.deleteOpen=!1),Ofertaa:e.Ofertao,title:n.title},null,8,["numberPermissions","show","Ofertaa","title"])):i("",!0),c(ee,{show:e.DetalleOpen,eldetalle:e.eldetalle,onClose:o[1]||(o[1]=s=>e.DetalleOpen=!1),title:n.title,maintitle:"Oferta"},null,8,["show","eldetalle","title"]),c(Y,{show:e.deleteBulkOpen,onClose:o[2]||(o[2]=s=>(e.deleteBulkOpen=!1,e.multipleSelect=!1,e.selectedId=[])),selectedId:e.selectedId,title:n.title},null,8,["show","selectedId","title"])])]),t("div",le,[t("div",de,[t("div",ne,[c(J,{modelValue:e.params.perPage,"onUpdate:modelValue":o[3]||(o[3]=s=>e.params.perPage=s),dataSet:e.dataSet},null,8,["modelValue","dataSet"]),b((r(),y(H,{onClick:o[4]||(o[4]=s=>e.deleteBulkOpen=!0),class:"px-3 py-1.5"},{default:_(()=>[c(p(W),{class:"w-5 h-5"})]),_:1})),[[q,e.selectedId.length!=0&&a.can(["delete oferta"])],[u,a.lang().tooltip.delete_selected]])]),n.numberPermissions>1?(r(),y(Z,{key:0,modelValue:e.params.search,"onUpdate:modelValue":o[5]||(o[5]=s=>e.params.search=s),type:"text",class:"block w-4/6 md:w-3/6 lg:w-2/6 rounded-lg",placeholder:"CÃ³digo, empresa o proyecto"},null,8,["modelValue"])):i("",!0)]),t("div",ie,[n.total>0?(r(),d("table",ce,[t("thead",pe,[t("tr",me,[t("th",fe,[c(te,{checked:e.multipleSelect,"onUpdate:checked":o[6]||(o[6]=s=>e.multipleSelect=s),onChange:j},null,8,["checked"])]),f.numberPermissions>1?(r(),d("th",ue,"Accion")):i("",!0),_e,(r(),d(h,null,x(w,s=>t("th",{class:"px-2 py-4 cursor-pointer",onClick:g=>V(s.order)},[t("div",he,[t("span",null,m(a.lang().label[s.label]),1),c(p(O),{class:"w-4 h-4"})])],8,ye)),64)),t("th",be,[t("div",ge,[ke,c(p(O),{class:"w-4 h-4"})])])])]),t("tbody",null,[(r(!0),d(h,null,x(n.fromController.data,(s,g)=>(r(),d("tr",{key:g,class:"border-t border-gray-200 dark:border-gray-700 hover:bg-gray-200/30 hover:dark:bg-gray-900/20"},[t("td",xe,[b(t("input",{class:"rounded dark:bg-gray-900 border-gray-300 dark:border-gray-700 text-primary dark:text-primary shadow-sm focus:ring-primary/80 dark:focus:ring-primary dark:focus:ring-offset-gray-800 dark:checked:bg-primary dark:checked:border-primary",type:"checkbox",onChange:B,value:s.id,"onUpdate:modelValue":o[7]||(o[7]=l=>e.selectedId=l)},null,40,we),[[K,e.selectedId]])]),f.numberPermissions>1?(r(),d("td",ve,[t("div",Oe,[t("div",$e,[a.can(["create oferta"])?(r(),y(p(v),{key:0,href:"/EditOferta/"+s.id,class:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-200 rounded-l-lg hover:bg-indigo-500 focus:z-10 focus:ring-1 focus:ring-indigo-800 focus:border-indigo-800 hover:text-white"},{default:_(()=>[t("span",Pe,[c(p(se),{class:"w-4 h-4 mr-1"}),Se])]),_:2},1032,["href"])):i("",!0),b((r(),d("button",{onClick:L(l=>N(s),["prevent"]),class:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border-t border-b border-r border-gray-200 rounded-r-lg hover:bg-indigo-500 hover:text-white focus:z-10 focus:ring-1 focus:ring-blue-500 focus:border-blue-500"},[k(" Descargar PDF ")],8,De)),[[u,"Descargar PDF"]])])])])):i("",!0),t("td",Ie,m(++g),1),(r(),d(h,null,x(w,l=>t("td",Ve,[l.type==="text"||l.type==="string"?(r(),d("span",je,m(s[l.order]),1)):i("",!0),l.type==="number"?(r(),d("span",Be,m(p($)(s[l.order],0,!1)),1)):i("",!0),l.type==="dinero"?(r(),d("span",Ne,m(p($)(s[l.order],0,!0)),1)):i("",!0),l.type==="date"?(r(),d("span",Ce,m(p(P)(s[l.order],!1)),1)):i("",!0),l.type==="datetime"?(r(),d("span",Ue,m(p(P)(s[l.order],!0)),1)):i("",!0),l.type==="foreign"?(r(),d("span",Ee,m((s==null?void 0:s[l==null?void 0:l.nameid])??""),1)):i("",!0)])),64)),b((r(),d("td",{onClick:l=>(e.DetalleOpen=!0,e.eldetalle=s),class:"whitespace-nowrap py-4 px-2 sm:py-3 cursor-pointer text-blue-600 dark:text-blue-400 font-bold underline"},[k(m(s.QuantityItems)+" Items ",1)],8,Te)),[[u,a.lang().tooltip.v_alfa]])]))),128)),t("tr",ze,[f.numberPermissions>1?(r(),d("td",Ae," - ")):i("",!0),Me,t("td",qe,m(n.total),1)])])])):(r(),d("h2",Ke,"Sin Registros"))]),n.total>0?(r(),d("div",Le,[c(X,{links:n.fromController,filters:e.params},null,8,["links","filters"])])):i("",!0)])])]),_:1})],64)}}};export{pt as default};
